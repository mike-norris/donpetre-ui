import{a as K,g as O,r as j,b as E,_ as V,d as f,j as t,s as C,e as X,f as v,h as Y,v as Z,w as Q,x as D,y as ee,z as te,c as re,u as se,B as S,p as G,T as M,P as ae,M as L,G as z,D as oe}from"./index-DR-c1u_z.js";import{G as U,J as F,s as W}from"./sources-pJugesbV.js";import{B as A}from"./Button-BbzPHUkG.js";import{A as ie}from"./ArrowBack-B8bbD1Dr.js";import{A as J}from"./Alert-CCF4D8eA.js";import{F as ne,I as ce,S as le,T as m}from"./TextField-BWxT91tF.js";import{C as ue,a as de}from"./CardContent-CNKmCIt5.js";import{S as pe,F as he}from"./FormControlLabel-C52aOkND.js";import{S as ge}from"./Save-dCNWpKep.js";function xe(e){return K("MuiCircularProgress",e)}O("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const me=["className","color","disableShrink","size","style","thickness","value","variant"];let P=e=>e,_,N,H,q;const k=44,ve=Q(_||(_=P`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),fe=Q(N||(N=P`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),be=e=>{const{classes:r,variant:o,color:i,disableShrink:d}=e,p={root:["root",o,`color${v(i)}`],svg:["svg"],circle:["circle",`circle${v(o)}`,d&&"circleDisableShrink"]};return Y(p,xe,r)},ke=C("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.root,r[o.variant],r[`color${v(o.color)}`]]}})(({ownerState:e,theme:r})=>f({display:"inline-block"},e.variant==="determinate"&&{transition:r.transitions.create("transform")},e.color!=="inherit"&&{color:(r.vars||r).palette[e.color].main}),({ownerState:e})=>e.variant==="indeterminate"&&Z(H||(H=P`
      animation: ${0} 1.4s linear infinite;
    `),ve)),ye=C("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,r)=>r.svg})({display:"block"}),je=C("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.circle,r[`circle${v(o.variant)}`],o.disableShrink&&r.circleDisableShrink]}})(({ownerState:e,theme:r})=>f({stroke:"currentColor"},e.variant==="determinate"&&{transition:r.transitions.create("stroke-dashoffset")},e.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink&&Z(q||(q=P`
      animation: ${0} 1.4s ease-in-out infinite;
    `),fe)),Ce=j.forwardRef(function(r,o){const i=E({props:r,name:"MuiCircularProgress"}),{className:d,color:p="primary",disableShrink:l=!1,size:h=40,style:g,thickness:a=3.6,value:u=0,variant:x="indeterminate"}=i,n=V(i,me),w=f({},i,{color:p,disableShrink:l,size:h,thickness:a,value:u,variant:x}),I=be(w),$={},R={},T={};if(x==="determinate"){const s=2*Math.PI*((k-a)/2);$.strokeDasharray=s.toFixed(3),T["aria-valuenow"]=Math.round(u),$.strokeDashoffset=`${((100-u)/100*s).toFixed(3)}px`,R.transform="rotate(-90deg)"}return t.jsx(ke,f({className:X(I.root,d),style:f({width:h,height:h},R,g),ownerState:w,ref:o,role:"progressbar"},T,n,{children:t.jsx(ye,{className:I.svg,ownerState:w,viewBox:`${k/2} ${k/2} ${k} ${k}`,children:t.jsx(je,{className:I.circle,style:$,ownerState:w,cx:k,cy:k,r:(k-a)/2,fill:"none",strokeWidth:a})})}))});function we(e){return K("MuiSwitch",e)}const c=O("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Se=["className","color","edge","size","sx"],Ie=e=>{const{classes:r,edge:o,size:i,color:d,checked:p,disabled:l}=e,h={root:["root",o&&`edge${v(o)}`,`size${v(i)}`],switchBase:["switchBase",`color${v(d)}`,p&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},g=Y(h,we,r);return f({},r,g)},$e=C("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.root,o.edge&&r[`edge${v(o.edge)}`],r[`size${v(o.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${c.thumb}`]:{width:16,height:16},[`& .${c.switchBase}`]:{padding:4,[`&.${c.checked}`]:{transform:"translateX(16px)"}}}}]}),Te=C(pe,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.switchBase,{[`& .${c.input}`]:r.input},o.color!=="default"&&r[`color${v(o.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${c.checked}`]:{transform:"translateX(20px)"},[`&.${c.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${c.checked} + .${c.track}`]:{opacity:.5},[`&.${c.disabled} + .${c.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${c.input}`]:{left:"-100%",width:"300%"}}),({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:D(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{color:r},style:{[`&.${c.checked}`]:{color:(e.vars||e).palette[r].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[r].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:D(e.palette[r].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${c.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${r}DisabledColor`]:`${e.palette.mode==="light"?ee(e.palette[r].main,.62):te(e.palette[r].main,.55)}`}},[`&.${c.checked} + .${c.track}`]:{backgroundColor:(e.vars||e).palette[r].main}}}))]})),Re=C("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,r)=>r.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),Ae=C("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,r)=>r.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Pe=j.forwardRef(function(r,o){const i=E({props:r,name:"MuiSwitch"}),{className:d,color:p="primary",edge:l=!1,size:h="medium",sx:g}=i,a=V(i,Se),u=f({},i,{color:p,edge:l,size:h}),x=Ie(u),n=t.jsx(Ae,{className:x.thumb,ownerState:u});return t.jsxs($e,{className:X(x.root,d),sx:g,ownerState:u,children:[t.jsx(Te,f({type:"checkbox",icon:n,checkedIcon:n,ref:o,ownerState:u},a,{classes:f({},x,{root:x.switchBase})})),t.jsx(Re,{className:x.track,ownerState:u})]})}),Be=re(t.jsx("path",{d:"M19.8 18.4 14 10.67V6.5l1.35-1.69c.26-.33.03-.81-.39-.81H9.04c-.42 0-.65.48-.39.81L10 6.5v4.17L4.2 18.4c-.49.66-.02 1.6.8 1.6h14c.82 0 1.29-.94.8-1.6"}),"Science"),_e=()=>{const e=se(),[r,o]=j.useState(!1),[i,d]=j.useState(!1),[p,l]=j.useState(""),[h,g]=j.useState(""),[a,u]=j.useState({type:"GITHUB",configuration:{},isActive:!0}),x=s=>{u({type:s,configuration:{},isActive:!0}),l(""),g("")},n=(s,y)=>{u({...a,configuration:{...a.configuration,[s]:y}}),l(""),g("")},w=async()=>{var s,y;d(!0),l(""),g("");try{const b=await W.testConnection(a);b.success?g(b.message||"Connection test successful!"):l(b.message||"Connection test failed")}catch(b){l(((y=(s=b.response)==null?void 0:s.data)==null?void 0:y.message)||"Connection test failed")}finally{d(!1)}},I=async s=>{var y,b;s.preventDefault(),o(!0),l("");try{const B=await W.createKnowledgeSource(a);e(G.sourcesView.replace(":id",B.id))}catch(B){l(((b=(y=B.response)==null?void 0:y.data)==null?void 0:b.message)||"Failed to create knowledge source")}finally{o(!1)}},$=s=>{switch(s){case"GITHUB":return t.jsx(U,{sx:{mr:1}});case"JIRA":return t.jsx(F,{sx:{mr:1}});case"GITLAB":return t.jsx(z,{sx:{mr:1}});default:return t.jsx(z,{sx:{mr:1}})}},R=()=>{switch(a.type){case"GITHUB":return t.jsxs(t.Fragment,{children:[t.jsx(m,{fullWidth:!0,label:"GitHub Token",type:"password",value:a.configuration.token||"",onChange:s=>n("token",s.target.value),helperText:"Personal access token with repo and read:org permissions",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"Repository Owner/Organization",value:a.configuration.owner||"",onChange:s=>n("owner",s.target.value),helperText:"GitHub username or organization name",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"Repository Name (optional)",value:a.configuration.repo||"",onChange:s=>n("repo",s.target.value),helperText:"Leave empty to sync all repositories in the organization",sx:{mb:3}})]});case"JIRA":return t.jsxs(t.Fragment,{children:[t.jsx(m,{fullWidth:!0,label:"JIRA URL",value:a.configuration.url||"",onChange:s=>n("url",s.target.value),placeholder:"https://yourcompany.atlassian.net",helperText:"Your JIRA instance URL",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"Username/Email",value:a.configuration.username||"",onChange:s=>n("username",s.target.value),helperText:"Your JIRA username or email address",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"API Token",type:"password",value:a.configuration.token||"",onChange:s=>n("token",s.target.value),helperText:"JIRA API token from your account settings",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"Project Key",value:a.configuration.projectKey||"",onChange:s=>n("projectKey",s.target.value),helperText:"JIRA project key (e.g., 'PROJ')",sx:{mb:3},required:!0})]});case"GITLAB":return t.jsxs(t.Fragment,{children:[t.jsx(m,{fullWidth:!0,label:"GitLab URL",value:a.configuration.url||"https://gitlab.com",onChange:s=>n("url",s.target.value),helperText:"GitLab instance URL (use https://gitlab.com for GitLab.com)",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"Personal Access Token",type:"password",value:a.configuration.token||"",onChange:s=>n("token",s.target.value),helperText:"GitLab personal access token with api scope",sx:{mb:3},required:!0}),t.jsx(m,{fullWidth:!0,label:"Project ID or Path",value:a.configuration.projectId||"",onChange:s=>n("projectId",s.target.value),helperText:"GitLab project ID or full path (e.g., 'group/project')",sx:{mb:3},required:!0})]});default:return null}},T=()=>{const{configuration:s}=a;switch(a.type){case"GITHUB":return s.token&&s.owner;case"JIRA":return s.url&&s.username&&s.token&&s.projectKey;case"GITLAB":return s.url&&s.token&&s.projectId;default:return!1}};return t.jsxs(S,{sx:{maxWidth:800,mx:"auto"},children:[t.jsxs(S,{sx:{display:"flex",alignItems:"center",mb:3},children:[t.jsx(A,{startIcon:t.jsx(ie,{}),onClick:()=>e(G.sources),sx:{mr:2},children:"Back"}),t.jsx(M,{variant:"h4",component:"h1",children:"Add Knowledge Source"})]}),t.jsxs(ae,{sx:{p:3},children:[p&&t.jsx(J,{severity:"error",sx:{mb:3},children:p}),h&&t.jsx(J,{severity:"success",sx:{mb:3},children:h}),t.jsxs(S,{component:"form",onSubmit:I,children:[t.jsxs(ne,{fullWidth:!0,sx:{mb:3},children:[t.jsx(ce,{children:"Source Type"}),t.jsxs(le,{value:a.type,label:"Source Type",onChange:s=>x(s.target.value),children:[t.jsxs(L,{value:"GITHUB",children:[t.jsx(U,{sx:{mr:1}})," GitHub"]}),t.jsxs(L,{value:"JIRA",children:[t.jsx(F,{sx:{mr:1}})," JIRA"]}),t.jsxs(L,{value:"GITLAB",children:[t.jsx(z,{sx:{mr:1}})," GitLab"]})]})]}),t.jsx(ue,{sx:{mb:3},children:t.jsxs(de,{children:[t.jsxs(S,{sx:{display:"flex",alignItems:"center",mb:2},children:[$(a.type),t.jsxs(M,{variant:"h6",children:[a.type," Configuration"]})]}),t.jsx(oe,{sx:{mb:3}}),R()]})}),t.jsx(he,{control:t.jsx(Pe,{checked:a.isActive,onChange:s=>u({...a,isActive:s.target.checked})}),label:"Enable this source (start syncing immediately)",sx:{mb:3}}),t.jsx(S,{sx:{display:"flex",gap:2,mb:3},children:t.jsx(A,{variant:"outlined",startIcon:i?t.jsx(Ce,{size:16}):t.jsx(Be,{}),onClick:w,disabled:!T()||i,children:i?"Testing...":"Test Connection"})}),t.jsxs(S,{sx:{display:"flex",gap:2},children:[t.jsx(A,{type:"submit",variant:"contained",startIcon:t.jsx(ge,{}),disabled:r||!T(),children:r?"Creating...":"Create Source"}),t.jsx(A,{variant:"outlined",onClick:()=>e(G.sources),children:"Cancel"})]})]})]})]})};export{_e as default};
//# sourceMappingURL=SourceCreate-KdtonqCd.js.map
